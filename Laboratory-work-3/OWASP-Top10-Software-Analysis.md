| Ідентифікатор та назва атаки (вразливості)                                                         | Вимога (FR,NFR)                                                                                                                                                                                         | Приклад вразливостей, які може використовувати атака                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Приклад запобігання успішної реалізації атаки                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|----------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| A1 – Broken Access Control (Порушений контроль доступу)                                            | FR1-FR10                                                                                                                                                                                                | Порушення принципу найменших привілеїв або заборони за замовчуванням, де доступ має надаватися лише для певних можливостей, ролей або користувачів, але доступний для всіх </br> Дозвіл на перегляд або редагування чужого облікового запису шляхом надання його унікального ідентифікатора (незахищені прямі посилання на об’єкти) </br> Доступ до API із відсутніми елементами керування доступом для POST, PUT і DELETE. <br/>Підвищення привілеїв. Можливість діяти як користувач без входу в систему або діяти як адміністратор, коли ви ввійшли як користувач.                                                                                                        | За винятком загальнодоступних ресурсів, заборонити доступ за замовчанням </br> Застосування механізмів контролю доступу один раз і повторне використання їх у всій програмі, включно з мінімізацією спільного використання ресурсів між джерелами (CORS). </br> Реєстрація збоїв контролю доступу, сповіщення адміністраторів, якщо це необхідно                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 
| A2 – Cryptographic Failures (Криптографічні збої)                                                  | FR2. Аутентифікація користувача                                                                                                                                                                         | Передача паролів як відкритого тексту.<br/>Використання старих чи слабких криптографічних ключів</br> Непримусове використання шифрування, відсутність заголовків безпекиу HTTP.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Класифікація даних, які обробляються, зберігаються або передаються програмою. Визначення, які дані є конфіденційними відповідно до законів про конфіденційність, нормативних вимог або потреб бізнесу</br> Відсутність зберігання конфіденційних даних без потреби. Стирання конфіденційних даних якнайшвидше або використання сумісної з PCI DSS токенізації.</br> Шифрування всіх конфіденційних даних в "стані спокою"</br> Забезпечення наявності актуальних і надійних стандартних алгоритмів, протоколів і ключів; використання правильного керування ключами.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| A3 – Injection (Впровадження)                                                                      | FR3. Керування даними співробітників, <br/>FR4. Опрацювання нового замовлення, <br/>FR7. Додавання страв до меню, <br/>FR8. Коригування страв меню                                                      | Відсутність валідацій та фільтрацій. Використання динамічних запитів або непараметризованих викликів без контекстно-залежного екранування в інтерпретаторі </br> Дані зловмисника використовуються в параметрах пошуку об’єктно-реляційного відображення (ORM) для отримання додаткових конфіденційних записів </br> Дані зловминика використовуються безпосередньо або об’єднуються.                                                                                                                                                                                                                                                                                       | Використання безпечного API, який повністю уникає використання інтерпретатора, надає параметризований інтерфейс або переходить на інструменти відображення об’єктів (ORM). Використання валідації на стороні сервера. Для будь-яких залишкових динамічних запитів екрануйте спеціальні символи, використовуючи спеціальний синтаксис екранування для цього інтерпретатора. Використовуйте LIMIT та інші елементи керування SQL у запитах, щоб запобігти масовому розкриттю записів у разі впровадження SQL.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| A5 – Security Misconfiguration (Неправильна конфігурація безпеки)                                  | NF1. Програмний продукт повинен представляти собою веб додаток                                                                                                                                          | Відсутність розшарування системи та інтерфейсних бар'єрів між компонентами системи </br> Перевантаження системи зайвим функціоналом </br> Недотримання принципів та патернів програмування. Відсутність бар'єру між тестуванням та реальними даними застосунку. <br/>Розкриття даних реалізації, логування та стеку помилок користувачеві.                                                                                                                                                                                                                                                                                                                                  | Мінімальна платформа без будь-яких непотрібних функцій, компонентів, документації та зразків. Видаліть або не встановлюйте функції та фреймворки, які не використовуються </br> Завдання переглядати й оновлювати конфігурації, що відповідають усім приміткам щодо безпеки, оновленням і виправленням у рамках процесу керування виправленнями. Перегляньте дозволи на хмарне сховище (наприклад, дозволи на відро S3) </br> Сегментована архітектура програми забезпечує ефективне та безпечне розділення між компонентами або орендарями за допомогою сегментації, контейнеризації або хмарних груп безпеки (ACL) </br> Надсилання директив безпеки клієнтам, наприклад, заголовків безпеки </br> Автоматизований процес перевірки ефективності конфігурацій і налаштувань у всіх середовищах                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 
| A6 – Vulnerable and Outdated Components (Вразливі та застарілі компоненти)                         | NF2. Додаток повинен коректно працювати в веб-браузерах з технологією Chromium v94...                                                                                                                   | Відсутність знань про версії всіх компонентів, які використовуються (як на стороні клієнта, так і на стороні сервера). Це включає компоненти, які ви використовуєте безпосередньо, а також вкладені залежності. Програмне забезпечення є вразливим, не підтримується або застаріло. Це включає ОС, веб-сервер/сервер додатків, систему керування базами даних (СУБД), програми, API та всі компоненти, середовища виконання та бібліотеки. Відсутність регулярного сканування на наявність уразливостей регулярно та підписуєтеся на бюлетені безпеки, пов’язані з компонентами, які ви використовуєте. Відсутність регулярних перевірок на сумісність оновлених бібліотек. | Видаліть невикористовувані залежності, непотрібні функції, компоненти, файли та документацію </br> Постійно інвентаризуйте версії як клієнтських, так і серверних компонентів (наприклад, фреймворків, бібліотек) і їхніх залежностей, використовуючи такі інструменти, як версії, OWASP Dependency Check, retire.js тощо. Постійно відстежуйте джерела, як-от загальні вразливості та експозиції (CVE) і національну базу даних про вразливості (NVD) щодо вразливостей у компонентах. Використовуйте інструменти аналізу складу програмного забезпечення для автоматизації процесу. Підпишіться на сповіщення електронною поштою про вразливості безпеки, пов’язані з компонентами, які ви використовуєте </br> Отримуйте компоненти лише з офіційних джерел через безпечні посилання. Віддавайте перевагу підписаним пакетам, щоб зменшити ймовірність включення модифікованого шкідливого компонента (див. A08:2021 – Збої цілісності програмного забезпечення та даних)</br> Слідкуйте за бібліотеками та компонентами, які не обслуговуються або не створюють виправлення безпеки для старіших версій. Якщо виправлення неможливо, подумайте про розгортання віртуального патча для моніторингу, виявлення або захисту від виявленої проблеми |
| A7 – Identification and Authentication Failures (Помилки ідентифікації та автентифікації)          | FR1. Реєстрація співробітника в системі, FR2. Аутентифікація користувача                                                                                                                                | Відсутня або неефективна багатофакторна автентифікація </br> Розкриває ідентифікатор сеансу в URL-адресі </br> Повторне використання ідентифікатора сеансу після успішного входу </br> Ідентифікатори сеансу неправильно роблять недійсними. Сеанси користувача або маркери автентифікації (переважно маркери єдиного входу (SSO)) не анулюються належним чином під час виходу з системи або періоду бездіяльності </br> Дозволяє автоматизовані атаки, як-от перекидання облікових даних, коли зловмисник має список дійсних імен користувачів і паролі                                                                                                                    | Якщо це можливо, застосуйте багатофакторну автентифікацію, щоб запобігти автоматизованому підкиданню облікових даних, грубій форсації та атакам повторного використання вкрадених облікових даних </br> Не надсилайте та не розгортайте облікові дані за замовчуванням, особливо для користувачів із правами адміністратора. Використовуйте серверний безпечний вбудований менеджер сеансів, який генерує новий випадковий ідентифікатор сеансу з високою ентропією після входу. Ідентифікатор сеансу не має бути в URL-адресі, надійно зберігатися та вважатися недійсним після виходу з системи, простою та абсолютних тайм-аутів                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | 
| A8 – Software and Data Integrity Failures (Порушення цілісності програмного забезпечення та даних) | FR1 Реєстрація співробітника в системі, FR3. Керування даними співробітників, FR4. Опрацювання нового замовлення, FR5. Скасування замовлення, FR7. Додавання страв до меню, FR8. Коригування страв меню | Незахищений конвеєр CI/CD може призвести до несанкціонованого доступу, зловмисного коду або компрометації системи </br> Зловмисники потенційно можуть завантажити власні оновлення для розповсюдження та запуску на всіх інсталяціях                                                                                                                                                                                                                                                                                                                                                                                                                                        | Використовуйте цифрові підписи або подібні механізми, щоб переконатися, що програмне забезпечення або дані походять з очікуваного джерела та не були змінені </br> Переконайтеся, що бібліотеки та залежності, такі як npm або Maven, використовують надійні репозиторії. Якщо у вас вищий профіль ризику, подумайте про розміщення перевіреного внутрішнього завідомо справного сховища </br> Переконайтеся, що є процес перевірки коду та змін конфігурації, щоб мінімізувати ймовірність того, що зловмисний код або конфігурація можуть бути введені у ваш конвеєр програмного забезпечення </br> Переконайтеся, що ваш конвеєр CI/CD має належну сегрегацію, конфігурацію та контроль доступу, щоб забезпечити цілісність коду, що проходить через процеси створення та розгортання <br> Переконайтеся, що непідписані або незашифровані серіалізовані дані не надсилаються ненадійним клієнтам без певної форми перевірки цілісності або цифрового підпису для виявлення підробки або повторного відтворення серіалізованих даних                                                                                                                                                                                                             | 
| A9 – Security Logging and Monitoring Failures (Помилки логування та відстлідковування безпеки)     | FR2. Аутентифікація користувача                                                                                                                                                                         | Попередження та помилки не створюють жодних, неадекватних або незрозумілих повідомлень журналу </br> Журнали програм і API не перевіряються на наявність підозрілої активності </br> Журнали зберігаються лише локально </br> Відповідні порогові значення сповіщень і процеси ескалації відповіді відсутні або не діють </br> Програма не може виявляти, ескалувати або сповіщати про активні атаки в режимі реального часу або майже в реальному часі                                                                                                                                                                                                                     | Переконайтеся, що журнали генеруються у форматі, який легко можуть використовувати рішення для керування журналами </br> Переконайтеся, що дані журналу закодовані правильно, щоб запобігти ін’єкціям або атакам на системи реєстрації чи моніторингу </br> Переконайтеся, що транзакції з великою вартістю мають журнал аудиту з контролем цілісності, щоб запобігти втручанню або видаленню, наприклад таблиці бази даних, які лише додаються, тощо                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 
| A10 – Server-Side Request Forgery (Підробка запитів на стороні сервера)                            | NF1. Програмний продукт повинен представляти собою веб додаток                                                                                                                                          | Помилки SSRF виникають щоразу, коли веб-програма отримує віддалений ресурс без перевірки наданої користувачем URL-адреси. Це дозволяє зловмиснику змусити програму надіслати створений запит до неочікуваного адресата, навіть якщо він захищений брандмауером, VPN або іншим типом списку контролю доступу до мережі (ACL).                                                                                                                                                                                                                                                                                                                                                | Розділіть функції віддаленого доступу до ресурсів у окремі мережі, щоб зменшити вплив SSRF </br> Застосуйте політику брандмауера «відмовити за замовчуванням» або правила контролю доступу до мережі, щоб блокувати весь інтрамережевий трафік, крім основного.<br/>Очистіть і перевірте всі вхідні дані, надані клієнтом </br>Застосуйте схему URL-адреси, порт і призначення за допомогою позитивного дозволеного списку<br/> Не надсилайте необроблені відповіді клієнтам </br>Вимкніть перенаправлення HTTP<br/> Не розгортайте інші служби безпеки на передніх системах (наприклад, OpenID). Контролювати локальний трафік у цих системах (наприклад, localhost) </br> Для інтерфейсів із виділеними та керованими групами користувачів використовуйте мережеве шифрування (наприклад, VPN) у незалежних системах, щоб враховувати дуже високі потреби захисту                                                                                                                                                                                                                                                                                                                                                                                 |
