## Тест на час процесу
| ID |
|---|
|WSTG-BUSL-04|

### Короткі відомості
Цілком можливо, що зловмисники можуть зібрати інформацію про програму, відстежуючи час, потрібний для виконання завдання або надання відповіді. Крім того, зловмисники можуть маніпулювати та порушувати розроблені потоки бізнес-процесів, просто залишаючи активні сеанси відкритими та не надсилаючи свої транзакції в «очікуваний» період часу.

Уразливість логіки синхронізації процесу унікальна тим, що ці випадки неправильного використання вручну слід створювати з урахуванням часу виконання та часу транзакції, які залежать від програми/системи.

Час обробки може дати/витік інформації про те, що робиться у фонових процесах програми/системи. Якщо програма дозволяє користувачам вгадувати, яким буде конкретний наступний результат, обробляючи варіації часу, користувачі зможуть відповідним чином коригувати та змінювати поведінку на основі очікувань і «грати з системою».

### Приклад 1
Відеоігорні/ігрові автомати можуть довше обробляти трансакцію безпосередньо перед великою виплатою. Це дозволить спритним гравцям грати в азартні ігри на мінімальні суми, поки вони не побачать тривалий час процесу, який потім спонукатиме їх робити максимальну ставку.

### Приклад 2
Багато процесів входу в систему запитують ім’я користувача та пароль. Якщо ви уважно придивитеся, ви можете побачити, що введення недійсного імені користувача та недійсного пароля користувача потребує більше часу для повернення помилки, ніж введення правильного імені користувача та недійсного пароля користувача. Це може дозволити зловмиснику дізнатися, чи є у нього дійсне ім’я користувача, і йому не потрібно покладатися на повідомлення GUI.
### Приклад 3
Більшість арен або туристичних агентств мають додатки для продажу квитків, які дозволяють користувачам купувати квитки та бронювати місця. Коли користувач запитує квитки, місця блокуються або резервуються в очікуванні оплати. Що робити, якщо зловмисник продовжує бронювати місця, але не виїжджає? Чи звільнять місця, чи не продадуть квитки? Деякі постачальники квитків тепер дають користувачам лише 5 хвилин для завершення транзакції, інакше транзакція стає недійсною.
### Приклад 4
Припустімо, що сайт електронної торгівлі дорогоцінними металами дозволяє користувачам робити покупки з ціновою пропозицією на основі ринкової ціни на момент входу в систему. Що, якщо зловмисник увійде в систему та розмістить замовлення, але не завершить транзакцію до того часу, коли ціна на метали зросте? Чи отримає нападник початкову нижчу ціну?

### Цілі тесту
- Перегляньте проектну документацію щодо функціональності системи, на яку може вплинути час.
- Розробляти та виконувати випадки неправильного використання.
### Як тестувати
Тестер повинен визначити, які процеси залежать від часу, чи було це вікно для виконання завдання, чи час виконання між двома процесами міг дозволити обійти певні засоби керування.

Після цього найкраще автоматизувати запити, які будуть зловживати описаними вище процесами, оскільки інструменти краще підходять для аналізу часу та є більш точними, ніж ручне тестування. Якщо це неможливо, все одно можна використовувати ручне тестування.

Тестер повинен намалювати діаграму того, як протікає процес, точки впровадження, і заздалегідь підготувати запити для їх запуску в уразливих процесах. Після цього слід провести ретельний аналіз, щоб виявити відмінності у виконанні процесу та виявити, чи процес поводиться неправильно всупереч узгодженій бізнес-логіці.

Пов’язані тестові випадки
- Тестування атрибутів файлів cookie
- Тайм-аут тестового сеансу

### Рішення
Розробляйте програми з урахуванням часу обробки. Якщо зловмисники можуть отримати певну перевагу, знаючи різний час обробки та результати, додайте додаткові кроки або обробку, щоб незалежно від результатів вони надавалися в той самий проміжок часу.

Крім того, програма/система повинна мати механізм, який не дозволить зловмисникам продовжити транзакції протягом «прийнятного» часу. Це можна зробити, скасувавши або скинувши транзакції після закінчення певного часу, як зараз використовують деякі постачальники квитків.
