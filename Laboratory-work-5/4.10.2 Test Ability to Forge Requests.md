## Перевірка здатності підробляти запити

| ID |
|---|
| WSTG-BUSL-02 |

### Короткі відомості
Підробка запитів — це метод, який використовують зловмисники, щоб обійти зовнішню програму графічного інтерфейсу користувача для безпосереднього надсилання інформації для внутрішньої обробки. Метою зловмисника є надсилання HTTP-запитів POST/GET через проксі-сервер-перехоплювач зі значеннями даних, які не підтримуються, не захищаються або не очікуються бізнес-логікою програми. Деякі приклади підроблених запитів включають використання параметрів, які можна вгадати або передбачити, або розкриття «прихованих» функцій і функцій, таких як увімкнення налагодження або представлення спеціальних екранів чи вікон, які дуже корисні під час розробки, але можуть призвести до витоку інформації або обійти бізнес-логіку.

Уразливості, пов’язані зі здатністю підробляти запити, є унікальними для кожної програми та відрізняються від перевірки даних бізнес-логіки тим, що вони зосереджені на порушенні робочого процесу бізнес-логіки.

Програми повинні мати логічні перевірки, щоб запобігти прийняттю системою підроблених запитів, які можуть надати зловмисникам можливість використовувати бізнес-логіку, процес або потік програми. Підробка запитів не є чимось новим; зловмисник використовує проксі-сервер-перехоплювач для надсилання запитів HTTP POST/GET до програми. За допомогою підробок запитів зловмисники можуть обійти бізнес-логіку або процес, знаходячи, прогнозуючи та маніпулюючи параметрами, щоб змусити програму вважати, що процес або завдання відбулися або не відбулися.

Крім того, підроблені запити можуть дозволити субсидувати потік програмної або бізнес-логіки, викликаючи «приховані» функції або функції, такі як налагодження, яке спочатку використовувалося розробниками та тестувальниками, іноді називають «пасхальним яйцем» . «Великоднє яйце — це навмисний внутрішній жарт, приховане повідомлення або особливість такого твору, як комп’ютерна програма, фільм, книга чи кросворд. За словами дизайнера ігор Уоррена Робінетта, цей термін був введений в Atari персоналом, який був попереджений про наявність секретного повідомлення, яке Робінетт приховав у своїй вже широко поширеній грі Adventure. Кажуть, що ця назва викликає уявлення про традиційне полювання на пасхальні яйця».

### Приклад 1
Припустімо, що сайт електронної комерції театру дозволяє користувачам вибрати свій квиток, застосувати одноразову знижку 10% для літніх людей на весь розпродаж, переглянути проміжну суму та тендер на продаж. Якщо зловмисник може побачити через проксі-сервер, що програма має приховане поле (1 або 0), яке використовується бізнес-логікою, щоб визначити, чи була використана знижка чи ні. Тоді зловмисник може надіслати значення 1 або «знижка не використана» кілька разів, щоб скористатися тією самою знижкою кілька разів.

### Приклад 2
Припустімо, онлайн-відеогра виплачує жетони за бали, набрані за пошук піратських скарбів і піратів, а також за кожен пройдений рівень. Пізніше ці жетони можна буде обміняти на призи. Крім того, бали кожного рівня мають значення множника, що дорівнює рівню. Якби зловмисник міг побачити через проксі-сервер, що програма має приховане поле, яке використовувалося під час розробки та тестування для швидкого переходу на найвищі рівні гри, він міг би швидко перейти на найвищі рівні та швидко накопичити незароблені бали.

Крім того, якщо зловмиснику вдалося побачити через проксі-сервер, що програма має приховане поле, яке використовувалося під час розробки та тестування для ввімкнення журналу, який вказував, де інші онлайн-гравці або приховані скарби були відносно зловмисника, вони могли б швидко переходити до цих локацій і набирати бали.

Крім того, якщо зловмисник зміг побачити через проксі-сервер, що в програмі є приховане поле, яке використовувалося під час розробки та тестування для включення журналу, в якому вказувалося, де знаходяться інші онлайн-гравці або приховані скарби по відношенню до зловмисника, тоді вони зможуть швидко перейти в ці місця і набрати очки.

### Цілі тестування
- Перегляньте проектну документацію, щоб знайти вгадувані, передбачувані чи приховані функції полів.
- Вставте логічно достовірні дані, щоб обійти звичайний робочий процес бізнес-логіки.

### Як тестувати
#### Шляхом виявлення вгаданих значень
- Використовуючи проксі-сервер-перехоплювач, спостерігайте за HTTP POST/GET, шукаючи ознаки того, що значення збільшуються з регулярним інтервалом або їх легко вгадати.
- Якщо буде виявлено, що якесь значення можна вгадати, це значення може бути змінено, і можна отримати неочікувану видимість.
#### Шляхом виявлення прихованих опцій
- Використовуючи проксі-сервер-перехоплювач, спостерігайте за HTTP POST/GET, шукаючи ознаки прихованих функцій, таких як налагодження, які можна ввімкнути або активувати.
- Якщо такі знайдуться, спробуйте вгадати та змінити ці значення, щоб отримати іншу відповідь або поведінку програми.

### Пов’язані тестові випадки
- Тестування на наявність відкритих змінних сеансу
- Тестування на підробку міжсайтових запитів (CSRF)
- Тестування для перерахування облікових записів і угадываемой облікового запису користувача

### Рішення
Програма має бути достатньо розумною та розробленою з бізнес-логікою, яка не дозволить зловмисникам передбачити та маніпулювати параметрами, щоб підірвати потік програмної чи бізнес-логіки або використовувати приховані/недокументовані функції, такі як налагодження.
