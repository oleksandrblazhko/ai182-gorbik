## Тест обмеження кількості разів, коли функція може бути використана
| ID |
|---|
| WSTG-BUSL-05 |
### Короткі відомості
Багато проблем, які вирішують програми, вимагають обмеження кількості разів, які можна використовувати для функції або виконувати дії. Програми мають бути «достатньо розумними», щоб не дозволяти користувачеві перевищувати обмеження на використання цих функцій, оскільки в багатьох випадках кожного разу, коли використовується функція, користувач може отримати певну вигоду, яку необхідно враховувати, щоб належним чином компенсувати власнику . Наприклад: сайт електронної комерції може дозволяти користувачам застосовувати знижку лише один раз за трансакцію, або деякі програми можуть мати план передплати та дозволяти користувачам завантажувати лише три повні документи щомісяця.
Уразливості, пов’язані з перевіркою функціональних обмежень, стосуються конкретної програми, тому необхідно створювати випадки неправильного використання, які прагнуть виконувати частини програми/функцій/ чи дії більше, ніж допустиму кількість разів.
Зловмисники можуть обійти бізнес-логіку та виконати функцію більше разів, ніж «дозволено», використовуючи програму для особистої вигоди.
### Приклад
Припустімо, сайт електронної комерції дозволяє користувачам скористатися будь-якою з багатьох знижок на загальну суму покупки, а потім перейти до оформлення замовлення та проведення тендеру. Що відбувається, коли зловмисник повертається на сторінку знижок після отримання та застосування однієї «дозволеної» знижки? Чи можуть вони скористатися іншою знижкою? Чи можуть вони скористатися однією знижкою кілька разів?
## Цілі тесту
- Визначте функції, які повинні встановлювати обмеження на час їх виклику.
- Оцініть, чи встановлено логічне обмеження для функцій і чи воно належним чином перевірено.
## Як тестувати
- Перегляньте проектну документацію та скористайтеся дослідницьким тестуванням, шукаючи функції чи функції в додатку чи системі, які не слід виконувати більше ніж один раз або певну кількість разів протягом робочого процесу бізнес-логіки.
- Для кожної зі знайдених функцій і функцій, які слід виконувати лише один раз або певну кількість разів під час робочого процесу бізнес-логіки, розробіть випадки зловживань/неправильного використання, які можуть дозволити користувачеві виконувати більше ніж допустиму кількість разів. Наприклад, чи може користувач кілька разів переміщатися вперед і назад сторінками, виконуючи функцію, яка повинна виконуватися лише один раз? або користувач може завантажувати та розвантажувати візки для покупок, що дозволяє отримати додаткові знижки.
## Пов’язані тестові випадки
- Тестування для перерахування облікових записів і вгадування облікових записів користувачів
- Тестування на слабкий механізм блокування
### Рішення
Додаток має встановити жорсткі елементи керування, щоб запобігти зловживанню обмеженнями. Цього можна досягти, встановивши купон так, щоб він більше не був дійсним на рівні бази даних, щоб встановити ліміт лічильника на користувача на сервері або на рівні бази даних, оскільки всі користувачі мають бути ідентифіковані через сеанс, залежно від того, що краще для бізнес-вимог .
